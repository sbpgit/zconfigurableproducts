sap.ui.define(["com/prod/configproduct/controller/BaseController","sap/ui/model/json/JSONModel","sap/m/MessageToast","sap/m/MessageBox","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/Device"],function(e,t,i,s,o,r,n){"use strict";var a,d,l;return e.extend("com.prod.configproduct.controller.prodmaster",{onInit:function(){a=this;this.oListModel=new t;this.bus=sap.ui.getCore().getEventBus();this.bus.subscribe("data","refreshMaster",this.refreshMaster,this);this.bus.publish("nav","toBeginPage",{viewName:this.getView().getProperty("viewName")})},refreshMaster:function(){this.onAfterRendering()},onSearch:function(e){},handlePress:function(e){if(e){var t=e.getSource().getSelectedItem().getTitle();var i=e.getSource().getSelectedItem().getDescription();d.setProperty("/PRODUCTID",t);d.setProperty("/PRODDESC",i)}else{var s=d.getProperty("/PRODUCTID");d.setProperty("/PRODUCTID",s);var o=d.getProperty("/PRODDESC");d.setProperty("/PRODDESC",o)}a.getOwnerComponent().runAsOwner(function(){if(!a.oDetailView){try{a.oDetailView=sap.ui.view({viewName:"com.prod.configproduct.view.proddetail",type:"XML"});a.bus.publish("flexible","addDetailPage",a.oDetailView);a.bus.publish("nav","toDetailPage",{viewName:a.oDetailView.getViewName()});a.oDetailView.onAfterRendering()}catch(e){a.oDetailView.onAfterRendering()}}else{a.bus.publish("nav","toDetailPage",{viewName:a.oDetailView.getViewName()});a.oDetailView.onAfterRendering()}})},refreshMaster:function(){this.onAfterRendering()},onAfterRendering:function(){a=this;d=this.getModel("oGModel");this.i18n=this.getResourceBundle();this.oList=this.byId("idList");this.oList.setModel(a.oListModel);this.oList.removeSelections();if(this.oList.getBinding("items")){this.oList.getBinding("items").filter([])}a.getData();this.oList.attachEvent("updateFinished",function(){a.byId("masterTitle").setText(a.i18n.getText("masterTitle",[a.oList.getBinding("items").getLength()]))}.bind(a))},getData:function(){a=this;l=this.getModel("prod");this.getModel("prod").read("/ET_PRODUCTS",{success:function(e){a.oListModel.setData({results:e.results});d.setProperty("/PRODUCTID",e.results[0].PRODUCTID);d.setProperty("/PRODDESC",e.results[0].PRODDESC);d.setProperty("/PRODFAMILY",e.results[0].PRODFAMILY);d.setProperty("/LOCID",e.results[0].LOCID);a.getView().byId("idList").setSelectedItem(a.getView().byId("idList").getItems()[0],true);a.handlePress()},error:function(e){i.show(a.i18n.getText("getListErr"))}});this.oList.setModel(l);this.oList.bindItems({path:"/ET_PRODUCTS",template:new sap.m.StandardListItem({title:"{PRODUCTID}",description:"{PRODDESC}"})})},onUpdateFinished:function(e){a.byId("masterTitle").setText(a.i18n.getText("masterTitle",[a.oList.getBinding("items").getLength()]))}})});